<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git Contextor - Shared Access</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Git Contextor Shared Access</h1>
        </header>
        <main>
            <section id="share-info" class="card">
                <h2>Share Details</h2>
                <p><strong>Description:</strong> <span id="share-description">Enter API key to view details.</span></p>
                <p><strong>Expires:</strong> <span id="share-expires"></span></p>
            </section>

            <section id="chat-interface" class="card">
                <h2>Ask the AI</h2>
                <form id="shared-chat-form">
                    <div class="form-group">
                        <label for="share-api-key">Share API Key:</label>
                        <input type="password" id="share-api-key" placeholder="Paste your share key here" required>
                    </div>
                    <div class="form-group">
                        <label for="chat-query">Your Question:</label>
                        <textarea id="chat-query" placeholder="Ask about the repository..." required rows="4"></textarea>
                    </div>
                    <button type="submit">Ask</button>
                </form>
                <div id="chat-results-container" style="display: none;">
                    <h3>ðŸ¤– AI Response</h3>
                    <div id="chat-results"></div>
                    <div id="chat-context-container" style="display: none; margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h4 style="margin: 0; font-size: 1.1em; color: var(--subtle-text-color);">Context Used (<span id="chat-context-count">0</span> chunks)</h4>
                            <button id="toggle-context-btn" class="button-secondary">Show</button>
                        </div>
                        <div id="chat-context-details" style="display: none; margin-top: 15px;">
                            <!-- Context cards will be rendered here by JS -->
                        </div>
                    </div>
                </div>
            </section>

            <section id="search-interface" class="card">
                <h2>Semantic Search</h2>
                <form id="shared-search-form">
                    <div class="form-group">
                        <label for="search-query-input">Search Query:</label>
                        <textarea id="search-query-input" placeholder="Search for code snippets, documentation..." required rows="2"></textarea>
                    </div>
                    <button type="submit">Search</button>
                </form>
                <div id="search-results-container" style="display: none; margin-top: 20px;">
                    <h3>Search Results</h3>
                    <div id="search-results-list">
                        <!-- Search results will be rendered here by JS -->
                    </div>
                </div>
            </section>

            <section id="api-usage" class="card" style="display: none;">
                <h2>API Usage</h2>
                <p>You can also interact with this shared repository programmatically using the following endpoints and your Share API Key.</p>
                
                <div class="api-endpoint">
                    <h3>Get Share Information</h3>
                    <p><code>GET /shared/{shareId}/info</code></p>
                    <p>Retrieve details about the share, such as its description, expiration date, and query usage.</p>
                    <h4>Example (cURL)</h4>
                    <pre id="snippet-info-curl"></pre>
                </div>
                
                <div class="api-endpoint">
                    <h3>Chat with the Repository</h3>
                    <p><code>POST /shared/{shareId}/chat</code></p>
                    <p>Send a query to the repository AI and receive a context-aware response.</p>
                    <h4>Example (cURL)</h4>
                    <pre id="snippet-chat-curl"></pre>
                </div>
                
                <div class="api-endpoint">
                    <h3>Semantic Search in the Repository</h3>
                    <p><code>POST /shared/{shareId}/search</code></p>
                    <p>Perform a semantic search to find relevant code chunks or documents.</p>
                    <h4>Example (cURL)</h4>
                    <pre id="snippet-search-curl"></pre>
                </div>
            </section>
        </main>
        <footer>
            <p>Powered by Git Contextor</p>
        </footer>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="/js/shared.js"></script>
</body>
</html>
